"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[948],{948:function(t,e,r){let i,n;r.d(e,{LY:function(){return rK}});let o="abcdefghijklmnopqrstuvwxyz234567",s=Object.create(null);for(let t=0;t<o.length;t++)s[o[t]]=t;s["0"]=s.o,s["1"]=s.i;let a=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),l="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function u(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function f(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];if(!u(t))throw Error("Uint8Array expected");if(r.length>0&&!r.includes(t.length))throw Error("Uint8Array expected of length "+r+", got length="+t.length)}function c(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function h(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];for(let t=0;t<e.length;t++)e[t].fill(0)}function d(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function g(t,e){return t<<32-e|t>>>e}let y="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,p=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function b(t){if(f(t),y)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=p[t[r]];return e}let w={_0:48,_9:57,A:65,F:70,a:97,f:102};function m(t){return t>=w._0&&t<=w._9?t-w._0:t>=w.A&&t<=w.F?t-(w.A-10):t>=w.a&&t<=w.f?t-(w.a-10):void 0}function v(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);if(y)return Uint8Array.fromHex(t);let e=t.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);let i=new Uint8Array(r);for(let e=0,n=0;e<r;e++,n+=2){let r=m(t.charCodeAt(n)),o=m(t.charCodeAt(n+1));if(void 0===r||void 0===o)throw Error('hex string expected, got non-hex character "'+(t[n]+t[n+1])+'" at index '+n);i[e]=16*r+o}return i}function E(t){if("string"!=typeof t)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function x(t){return"string"==typeof t&&(t=E(t)),f(t),t}function _(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let i=0;for(let t=0;t<e.length;t++){let r=e[t];f(r),i+=r.length}let n=new Uint8Array(i);for(let t=0,r=0;t<e.length;t++){let i=e[t];n.set(i,r),r+=i.length}return n}class A{}function B(t){let e=e=>t().update(x(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function I(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(l&&"function"==typeof l.getRandomValues)return l.getRandomValues(new Uint8Array(t));if(l&&"function"==typeof l.randomBytes)return Uint8Array.from(l.randomBytes(t));throw Error("crypto.getRandomValues must be defined")}class O extends A{update(t){c(this),f(t=x(t));let{view:e,buffer:r,blockLen:i}=this,n=t.length;for(let o=0;o<n;){let s=Math.min(i-this.pos,n-o);if(s===i){let e=d(t);for(;i<=n-o;o+=i)this.process(e,o);continue}r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===i&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){c(this),function(t,e){f(t);let r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(t,this),this.finished=!0;let{buffer:e,view:r,blockLen:i,isLE:n}=this,{pos:o}=this;e[o++]=128,h(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let t=o;t<i;t++)e[t]=0;!function(t,e,r,i){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,i);let n=BigInt(32),o=BigInt(4294967295),s=Number(r>>n&o),a=Number(r&o),l=i?4:0,u=i?0:4;t.setUint32(e+l,s,i),t.setUint32(e+u,a,i)}(r,i-8,BigInt(8*this.length),n),this.process(r,0);let s=d(t),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let l=a/4,u=this.get();if(l>u.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<l;t++)s.setUint32(4*t,u[t],n)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:i,finished:n,destroyed:o,pos:s}=this;return t.destroyed=o,t.finished=n,t.length=i,t.pos=s,i%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}constructor(t,e,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(t),this.view=d(this.buffer)}}let S=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),D=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),U=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),L=BigInt(4294967296-1),C=BigInt(32),P=(t,e,r)=>t>>>r,R=(t,e,r)=>t<<32-r|e>>>r,T=(t,e,r)=>t>>>r|e<<32-r,k=(t,e,r)=>t<<32-r|e>>>r,N=(t,e,r)=>t<<64-r|e>>>r-32,K=(t,e,r)=>t>>>r-32|e<<64-r;function q(t,e,r,i){let n=(e>>>0)+(i>>>0);return{h:t+r+(n/4294967296|0)|0,l:0|n}}let j=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),H=(t,e,r,i)=>e+r+i+(t/4294967296|0)|0,F=(t,e,r,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0),V=(t,e,r,i,n)=>e+r+i+n+(t/4294967296|0)|0,M=(t,e,r,i,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)+(n>>>0),W=(t,e,r,i,n,o)=>e+r+i+n+o+(t/4294967296|0)|0,Z=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),z=new Uint32Array(64);class G extends O{get(){let{A:t,B:e,C:r,D:i,E:n,F:o,G:s,H:a}=this;return[t,e,r,i,n,o,s,a]}set(t,e,r,i,n,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)z[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=z[t-15],r=z[t-2],i=g(e,7)^g(e,18)^e>>>3,n=g(r,17)^g(r,19)^r>>>10;z[t]=n+z[t-7]+i+z[t-16]|0}let{A:r,B:i,C:n,D:o,E:s,F:a,G:l,H:u}=this;for(let t=0;t<64;t++){var f,c,h,d;let e=u+(g(s,6)^g(s,11)^g(s,25))+((f=s)&a^~f&l)+Z[t]+z[t]|0,y=(g(r,2)^g(r,13)^g(r,22))+((c=r)&(h=i)^c&(d=n)^h&d)|0;u=l,l=a,a=s,s=o+e|0,o=n,n=i,i=r,r=e+y|0}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,i,n,o,s,a,l,u)}roundClean(){h(z)}destroy(){this.set(0,0,0,0,0,0,0,0),h(this.buffer)}constructor(t=32){super(64,t,8,!1),this.A=0|S[0],this.B=0|S[1],this.C=0|S[2],this.D=0|S[3],this.E=0|S[4],this.F=0|S[5],this.G=0|S[6],this.H=0|S[7]}}class J extends G{constructor(){super(28),this.A=0|D[0],this.B=0|D[1],this.C=0|D[2],this.D=0|D[3],this.E=0|D[4],this.F=0|D[5],this.G=0|D[6],this.H=0|D[7]}}let Y=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.length,i=new Uint32Array(r),n=new Uint32Array(r);for(let o=0;o<r;o++){let{h:r,l:s}=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?{h:Number(t&L),l:Number(t>>C&L)}:{h:0|Number(t>>C&L),l:0|Number(t&L)}}(t[o],e);[i[o],n[o]]=[r,s]}return[i,n]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),X=Y[0],$=Y[1],Q=new Uint32Array(80),tt=new Uint32Array(80);class te extends O{get(){let{Ah:t,Al:e,Bh:r,Bl:i,Ch:n,Cl:o,Dh:s,Dl:a,Eh:l,El:u,Fh:f,Fl:c,Gh:h,Gl:d,Hh:g,Hl:y}=this;return[t,e,r,i,n,o,s,a,l,u,f,c,h,d,g,y]}set(t,e,r,i,n,o,s,a,l,u,f,c,h,d,g,y){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|i,this.Ch=0|n,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|l,this.El=0|u,this.Fh=0|f,this.Fl=0|c,this.Gh=0|h,this.Gl=0|d,this.Hh=0|g,this.Hl=0|y}process(t,e){for(let r=0;r<16;r++,e+=4)Q[r]=t.getUint32(e),tt[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){let e=0|Q[t-15],r=0|tt[t-15],i=T(e,r,1)^T(e,r,8)^P(e,r,7),n=k(e,r,1)^k(e,r,8)^R(e,r,7),o=0|Q[t-2],s=0|tt[t-2],a=T(o,s,19)^N(o,s,61)^P(o,s,6),l=F(n,k(o,s,19)^K(o,s,61)^R(o,s,6),tt[t-7],tt[t-16]),u=V(l,i,a,Q[t-7],Q[t-16]);Q[t]=0|u,tt[t]=0|l}let{Ah:r,Al:i,Bh:n,Bl:o,Ch:s,Cl:a,Dh:l,Dl:u,Eh:f,El:c,Fh:h,Fl:d,Gh:g,Gl:y,Hh:p,Hl:b}=this;for(let t=0;t<80;t++){let e=T(f,c,14)^T(f,c,18)^N(f,c,41),w=k(f,c,14)^k(f,c,18)^K(f,c,41),m=f&h^~f&g,v=M(b,w,c&d^~c&y,$[t],tt[t]),E=W(v,p,e,m,X[t],Q[t]),x=0|v,_=T(r,i,28)^N(r,i,34)^N(r,i,39),A=k(r,i,28)^K(r,i,34)^K(r,i,39),B=r&n^r&s^n&s,I=i&o^i&a^o&a;p=0|g,b=0|y,g=0|h,y=0|d,h=0|f,d=0|c,({h:f,l:c}=q(0|l,0|u,0|E,0|x)),l=0|s,u=0|a,s=0|n,a=0|o,n=0|r,o=0|i;let O=j(x,A,I);r=H(O,E,_,B),i=0|O}({h:r,l:i}=q(0|this.Ah,0|this.Al,0|r,0|i)),({h:n,l:o}=q(0|this.Bh,0|this.Bl,0|n,0|o)),({h:s,l:a}=q(0|this.Ch,0|this.Cl,0|s,0|a)),({h:l,l:u}=q(0|this.Dh,0|this.Dl,0|l,0|u)),({h:f,l:c}=q(0|this.Eh,0|this.El,0|f,0|c)),({h:h,l:d}=q(0|this.Fh,0|this.Fl,0|h,0|d)),({h:g,l:y}=q(0|this.Gh,0|this.Gl,0|g,0|y)),({h:p,l:b}=q(0|this.Hh,0|this.Hl,0|p,0|b)),this.set(r,i,n,o,s,a,l,u,f,c,h,d,g,y,p,b)}roundClean(){h(Q,tt)}destroy(){h(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}constructor(t=64){super(128,t,16,!1),this.Ah=0|U[0],this.Al=0|U[1],this.Bh=0|U[2],this.Bl=0|U[3],this.Ch=0|U[4],this.Cl=0|U[5],this.Dh=0|U[6],this.Dl=0|U[7],this.Eh=0|U[8],this.El=0|U[9],this.Fh=0|U[10],this.Fl=0|U[11],this.Gh=0|U[12],this.Gl=0|U[13],this.Hh=0|U[14],this.Hl=0|U[15]}}let tr=B(()=>new G),ti=B(()=>new J),tn=B(()=>new te),to="__principal__";class ts{static anonymous(){return new this(new Uint8Array([4]))}static managementCanister(){return this.fromText("aaaaa-aa")}static selfAuthenticating(t){let e=ti(t);return new this(new Uint8Array([...e,2]))}static from(t){if("string"==typeof t)return ts.fromText(t);if(Object.getPrototypeOf(t)===Uint8Array.prototype)return new ts(t);if(ts.isPrincipal(t))return new ts(t._arr);throw Error("Impossible to convert ".concat(JSON.stringify(t)," to Principal."))}static fromHex(t){return new this(v(t))}static fromText(t){let e=t;if(t.includes(to)){let r=JSON.parse(t);to in r&&(e=r[to])}let r=function(t){let e=0,r=0,i=new Uint8Array(4*t.length/3|0),n=0;for(let o of t)!function(t){let o=s[t.toLowerCase()];if(void 0===o)throw Error("Invalid character: ".concat(JSON.stringify(t)));o<<=3,r|=o>>>e,(e+=5)>=8&&(i[n++]=r,e-=8,r=e>0?o<<5-e&255:0)}(o);return i.slice(0,n)}(e.toLowerCase().replace(/-/g,"")),i=new this(r=r.slice(4,r.length));if(i.toText()!==e)throw Error('Principal "'.concat(i.toText(),'" does not have a valid checksum (original value "').concat(e,'" may not be a valid Principal ID).'));return i}static fromUint8Array(t){return new this(t)}static isPrincipal(t){return t instanceof ts||"object"==typeof t&&null!==t&&"_isPrincipal"in t&&!0===t._isPrincipal&&"_arr"in t&&t._arr instanceof Uint8Array}isAnonymous(){return 1===this._arr.byteLength&&4===this._arr[0]}toUint8Array(){return this._arr}toHex(){return b(this._arr).toUpperCase()}toText(){let t=new ArrayBuffer(4);new DataView(t).setUint32(0,function(t){let e=-1;for(let r=0;r<t.length;r++)e=a[(t[r]^e)&255]^e>>>8;return(-1^e)>>>0}(this._arr));let e=new Uint8Array(t),r=(function(t){let e=0,r=0,i="";for(let s=0;s<t.length;){var n;s+=(n=t[s],(e<0?r|=n>>-e:r=n<<e&248,e>3)?(e-=8,1):(e<4&&(i+=o[r>>3],e+=5),0))}return i+(e<0?o[r>>3]:"")})(new Uint8Array([...e,...this._arr])).match(/.{1,5}/g);if(!r)throw Error();return r.join("-")}toString(){return this.toText()}toJSON(){return{[to]:this.toText()}}compareTo(t){for(let e=0;e<Math.min(this._arr.length,t._arr.length);e++){if(this._arr[e]<t._arr[e])return"lt";if(this._arr[e]>t._arr[e])return"gt"}return this._arr.length<t._arr.length?"lt":this._arr.length>t._arr.length?"gt":"eq"}ltEq(t){let e=this.compareTo(t);return"lt"==e||"eq"==e}gtEq(t){let e=this.compareTo(t);return"gt"==e||"eq"==e}constructor(t){this._arr=t,this._isPrincipal=!0}}class ta{save(){return this._view}restore(t){if(!(t instanceof Uint8Array))throw Error("Checkpoint must be a Uint8Array");this._view=t}get buffer(){return this._view.slice()}get byteLength(){return this._view.byteLength}read(t){let e=this._view.subarray(0,t);return this._view=this._view.subarray(t),e.slice()}readUint8(){if(0===this._view.byteLength)return;let t=this._view[0];return this._view=this._view.subarray(1),t}write(t){if(!(t instanceof Uint8Array))throw Error("Buffer must be a Uint8Array");let e=this._view.byteLength;this._view.byteOffset+this._view.byteLength+t.byteLength>=this._buffer.byteLength?this.alloc(t.byteLength):this._view=new Uint8Array(this._buffer.buffer,this._view.byteOffset,this._view.byteLength+t.byteLength),this._view.set(t,e)}get end(){return 0===this._view.byteLength}alloc(t){if(t<=0||!Number.isInteger(t))throw Error("Amount must be a positive integer");let e=new Uint8Array((this._buffer.byteLength+t)*1.2|0),r=new Uint8Array(e.buffer,0,this._view.byteLength+t);r.set(this._view),this._buffer=e,this._view=r}constructor(t,e=(null==t?void 0:t.byteLength)||0){if(t&&!(t instanceof Uint8Array))try{t=tl(t)}catch(t){throw Error("Buffer must be a Uint8Array")}if(e<0||!Number.isInteger(e))throw Error("Length must be a non-negative integer");if(t&&e>t.byteLength)throw Error("Length cannot exceed buffer length");this._buffer=t||new Uint8Array(0),this._view=new Uint8Array(this._buffer.buffer,0,e)}}function tl(t){if(!t)throw Error("Input cannot be null or undefined");return t instanceof Uint8Array?t:t instanceof ArrayBuffer||Array.isArray(t)?new Uint8Array(t):"buffer"in t?tl(t.buffer):new Uint8Array(t)}function tu(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]-e[r];return 0}function tf(t){if("number"==typeof t&&(t=BigInt(t)),t<BigInt(0))throw Error("Cannot leb encode negative values.");let e=(t===BigInt(0)?0:function(t){let e=BigInt(t);if(t<=0)throw RangeError("Input must be positive");return e.toString(2).length-1}(t))+1,r=new ta(new Uint8Array(e),0);for(;;){let e=Number(t&BigInt(127));if((t/=BigInt(128))===BigInt(0)){r.write(new Uint8Array([e]));break}r.write(new Uint8Array([128|e]))}return r.buffer}(tI=tO||(tO={})).Trust="Trust",tI.Protocol="Protocol",tI.Reject="Reject",tI.Transport="Transport",tI.External="External",tI.Limit="Limit",tI.Input="Input",tI.Unknown="Unknown";class tc{toString(){let t=this.toErrorMessage();return this.requestContext&&(t+="\nRequest context:\n"+"  Request ID (hex): ".concat(this.requestContext.requestId?b(this.requestContext.requestId):"undefined","\n")+"  Sender pubkey (hex): ".concat(b(this.requestContext.senderPubKey),"\n")+"  Sender signature (hex): ".concat(b(this.requestContext.senderSignature),"\n")+"  Ingress expiry: ".concat(this.requestContext.ingressExpiry.toString())),this.callContext&&(t+="\nCall context:\n"+"  Canister ID: ".concat(this.callContext.canisterId.toText(),"\n")+"  Method name: ".concat(this.callContext.methodName,"\n")+"  HTTP details: ".concat(JSON.stringify(this.callContext.httpDetails,null,2))),t}constructor(t=!1){this.isCertified=t}}class th extends Error{get code(){return this.cause.code}set code(t){this.cause.code=t}get kind(){return this.cause.kind}set kind(t){this.cause.kind=t}get isCertified(){return this.code.isCertified}hasCode(t){return this.code instanceof t}toString(){return"".concat(this.name," (").concat(this.kind,"): ").concat(this.message)}constructor(t,e){super(t.toString()),this.name="AgentError",this.cause={code:t,kind:e},Object.setPrototypeOf(this,th.prototype)}}class td extends th{static fromCode(t){return new this(t)}}class tg extends td{constructor(t){super(t,tO.Input),this.name="InputError",Object.setPrototypeOf(this,tg.prototype)}}class ty extends tc{toErrorMessage(){return"DER payload mismatch: Expected length ".concat(this.expectedLength,", actual length: ").concat(this.actualLength)}constructor(t,e){super(),this.expectedLength=t,this.actualLength=e,this.name="DerDecodeLengthMismatchErrorCode",Object.setPrototypeOf(this,ty.prototype)}}class tp extends tc{toErrorMessage(){return"Failed to decode DER: ".concat(this.error)}constructor(t){super(),this.error=t,this.name="DerDecodeErrorCode",Object.setPrototypeOf(this,tp.prototype)}}class tb extends tc{toErrorMessage(){return"Failed to encode DER: ".concat(this.error)}constructor(t){super(),this.error=t,this.name="DerEncodeErrorCode",Object.setPrototypeOf(this,tb.prototype)}}class tw extends tc{toErrorMessage(){return"Attempt to hash a value of unsupported type: ".concat(this.value)}constructor(t){super(),this.value=t,this.name="HashValueErrorCode",Object.setPrototypeOf(this,tw.prototype)}}Error("unreachable");let tm=t=>tr(new TextEncoder().encode(t));function tv(t){let e=Object.entries(t).filter(t=>{let[,e]=t;return void 0!==e}).map(t=>{let[e,r]=t;return[tm(e),function t(e){if("string"==typeof e)return tm(e);if("number"==typeof e)return tr(tf(e));if(e instanceof Uint8Array||ArrayBuffer.isView(e))return tr(function t(e){if(!e)throw Error("Input cannot be null or undefined");return e instanceof Uint8Array?e:e instanceof ArrayBuffer||Array.isArray(e)?new Uint8Array(e):"buffer"in e?t(e.buffer):new Uint8Array(e)}(e));if(Array.isArray(e))return tr(_(...e.map(t)));if(e&&"object"==typeof e&&e._isPrincipal)return tr(e.toUint8Array());if("object"==typeof e&&null!==e&&"function"==typeof e.toHash)return t(e.toHash());if("object"==typeof e)return tv(e);else if("bigint"==typeof e)return tr(tf(e));throw tg.fromCode(new tw(e))}(r)]});return tr(_(...e.sort((t,e)=>{let[r]=t,[i]=e;return tu(r,i)}).map(t=>_(...t))))}let tE=new TextEncoder().encode("\nic-request");new TextEncoder().encode("\vic-response");let tx=new TextEncoder().encode("\x1aic-request-auth-delegation");class t_{getPrincipal(){return this._principal||(this._principal=ts.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(t){let{body:e,...r}=t,i=tv(e);return{...r,body:{content:e,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(_(tE,i))}}}}class tA{getPrincipal(){return ts.anonymous()}async transformRequest(t){return{...t,body:{content:t.body}}}}var tB,tI,tO,tS=r(2742),tD=r(7640),tU=r(7175);let tL=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw tg.fromCode(new tb("Length too long (> 4 bytes)"))},tC=(t,e,r)=>{if(r<=127)return t[e]=r,1;if(r<=255)return t[e]=129,t[e+1]=r,2;if(r<=65535)return t[e]=130,t[e+1]=r>>8,t[e+2]=r,3;if(r<=16777215)return t[e]=131,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r,4;throw tg.fromCode(new tb("Length too long (> 4 bytes)"))},tP=(t,e)=>{if(t[e]<128)return 1;if(128===t[e])throw tg.fromCode(new tp("Invalid length 0"));if(129===t[e])return 2;if(130===t[e])return 3;if(131===t[e])return 4;throw tg.fromCode(new tp("Length too long (> 4 bytes)"))},tR=(t,e)=>{let r=tP(t,e);if(1===r)return t[e];if(2===r)return t[e+1];if(3===r)return(t[e+1]<<8)+t[e+2];if(4===r)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw tg.fromCode(new tp("Length too long (> 4 bytes)"))};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);let tT=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]),Uint8Array.from([48,29,6,13,43,6,1,4,1,130,220,124,5,3,1,2,1,6,12,43,6,1,4,1,130,220,124,5,3,2,1]);let tk=(t,e)=>{let r=0,i=(t,e)=>{if(n[r++]!==t)throw tg.fromCode(new tp("Expected ".concat(e," at offset ").concat(r)))},n=new Uint8Array(t);if(i(48,"sequence"),r+=tP(n,r),!function(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}(n.slice(r,r+e.byteLength),e))throw tg.fromCode(new tp("Not the expected OID."));r+=e.byteLength,i(3,"bit string");let o=tR(n,r)-1;r+=tP(n,r),i(0,"0 padding");let s=n.slice(r);if(o!==s.length)throw tg.fromCode(new ty(o,s.length));return s},tN=BigInt(0),tK=BigInt(1);function tq(t,e){if("boolean"!=typeof e)throw Error(t+" boolean expected, got "+e)}function tj(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return""===t?tN:BigInt("0x"+t)}function tH(t){return f(t),tj(b(Uint8Array.from(t).reverse()))}function tF(t,e){return v(t.toString(16).padStart(2*e,"0"))}function tV(t,e){return tF(t,e).reverse()}function tM(t,e,r){let i;if("string"==typeof e)try{i=v(e)}catch(e){throw Error(t+" must be hex string or Uint8Array, cause: "+e)}else if(u(e))i=Uint8Array.from(e);else throw Error(t+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(t+" of length "+r+" expected, got "+n);return i}let tW=t=>"bigint"==typeof t&&tN<=t;function tZ(t,e,r,i){if(!(tW(e)&&tW(r)&&tW(i))||!(r<=e)||!(e<i))throw Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}let tz=t=>(tK<<BigInt(t))-tK;function tG(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||"object"!=typeof t)throw Error("expected valid options object");function i(e,r,i){let n=t[e];if(i&&void 0===n)return;let o=typeof n;if(o!==r||null===n)throw Error('param "'.concat(e,'" is invalid: expected ').concat(r,", got ").concat(o))}Object.entries(e).forEach(t=>{let[e,r]=t;return i(e,r,!1)}),Object.entries(r).forEach(t=>{let[e,r]=t;return i(e,r,!0)})}function tJ(t){let e=new WeakMap;return function(r){for(var i=arguments.length,n=Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];let s=e.get(r);if(void 0!==s)return s;let a=t(r,...n);return e.set(r,a),a}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let tY=BigInt(0),tX=BigInt(1),t$=BigInt(2),tQ=BigInt(3),t0=BigInt(4),t1=BigInt(5),t2=BigInt(7),t3=BigInt(8),t6=BigInt(9),t4=BigInt(16);function t8(t,e){let r=t%e;return r>=tY?r:e+r}function t5(t,e,r){let i=t;for(;e-- >tY;)i*=i,i%=r;return i}function t7(t,e){if(t===tY)throw Error("invert: expected non-zero number");if(e<=tY)throw Error("invert: expected positive modulus, got "+e);let r=t8(t,e),i=e,n=tY,o=tX,s=tX,a=tY;for(;r!==tY;){let t=i/r,e=i%r,l=n-s*t,u=o-a*t;i=r,r=e,n=s,o=a,s=l,a=u}if(i!==tX)throw Error("invert: does not exist");return t8(n,e)}function t9(t,e,r){if(!t.eql(t.sqr(e),r))throw Error("Cannot find square root")}function et(t,e){let r=(t.ORDER+tX)/t0,i=t.pow(e,r);return t9(t,i,e),i}function ee(t,e){let r=(t.ORDER-t1)/t3,i=t.mul(e,t$),n=t.pow(i,r),o=t.mul(e,n),s=t.mul(t.mul(o,t$),n),a=t.mul(o,t.sub(s,t.ONE));return t9(t,a,e),a}function er(t){if(t<tQ)throw Error("sqrt is not defined for small field");let e=t-tX,r=0;for(;e%t$===tY;)e/=t$,r++;let i=t$,n=ea(t);for(;1===es(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return et;let o=n.pow(i,e),s=(e+tX)/t$;return function(t,i){if(t.is0(i))return i;if(1!==es(t,i))throw Error("Cannot find square root");let n=r,a=t.mul(t.ONE,o),l=t.pow(i,e),u=t.pow(i,s);for(;!t.eql(l,t.ONE);){if(t.is0(l))return t.ZERO;let e=1,r=t.sqr(l);for(;!t.eql(r,t.ONE);)if(e++,r=t.sqr(r),e===n)throw Error("Cannot find square root");let i=tX<<BigInt(n-e-1),o=t.pow(a,i);n=e,a=t.sqr(o),l=t.mul(l,a),u=t.mul(u,o)}return u}}let ei=(t,e)=>(t8(t,e)&tX)===tX,en=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function eo(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Array(e.length).fill(r?t.ZERO:void 0),n=e.reduce((e,r,n)=>t.is0(r)?e:(i[n]=e,t.mul(e,r)),t.ONE),o=t.inv(n);return e.reduceRight((e,r,n)=>t.is0(r)?e:(i[n]=t.mul(e,i[n]),t.mul(e,r)),o),i}function es(t,e){let r=(t.ORDER-tX)/t$,i=t.pow(e,r),n=t.eql(i,t.ONE),o=t.eql(i,t.ZERO),s=t.eql(i,t.neg(t.ONE));if(!n&&!o&&!s)throw Error("invalid Legendre symbol result");return n?1:o?0:-1}function ea(t,e){let r,i,n,o,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t<=tY)throw Error("invalid field: expected ORDER > 0, got "+t);let l=!1;if("object"==typeof e&&null!=e){if(a.sqrt||s)throw Error("cannot specify opts in two arguments");e.BITS&&(r=e.BITS),e.sqrt&&(i=e.sqrt),"boolean"==typeof e.isLE&&(s=e.isLE),"boolean"==typeof e.modOnDecode&&(l=e.modOnDecode),n=e.allowedLengths}else"number"==typeof e&&(r=e),a.sqrt&&(i=a.sqrt);let{nBitLength:u,nByteLength:f}=function(t,e){void 0!==e&&function(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, got "+t)}(e);let r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}(t,r);if(f>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let c=Object.freeze({ORDER:t,isLE:s,BITS:u,BYTES:f,MASK:tz(u),ZERO:tY,ONE:tX,allowedLengths:n,create:e=>t8(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error("invalid field element: expected bigint, got "+typeof e);return tY<=e&&e<t},is0:t=>t===tY,isValidNot0:t=>!c.is0(t)&&c.isValid(t),isOdd:t=>(t&tX)===tX,neg:e=>t8(-e,t),eql:(t,e)=>t===e,sqr:e=>t8(e*e,t),add:(e,r)=>t8(e+r,t),sub:(e,r)=>t8(e-r,t),mul:(e,r)=>t8(e*r,t),pow:(t,e)=>(function(t,e,r){if(r<tY)throw Error("invalid exponent, negatives unsupported");if(r===tY)return t.ONE;if(r===tX)return e;let i=t.ONE,n=e;for(;r>tY;)r&tX&&(i=t.mul(i,n)),n=t.sqr(n),r>>=tX;return i})(c,t,e),div:(e,r)=>t8(e*t7(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>t7(e,t),sqrt:i||(e=>(!o&&(o=t%t0===tQ?et:t%t3===t1?ee:t%t4===t6?function(t){let e=ea(t),r=er(t),i=r(e,e.neg(e.ONE)),n=r(e,i),o=r(e,e.neg(i)),s=(t+t2)/t4;return(t,e)=>{let r=t.pow(e,s),a=t.mul(r,i),l=t.mul(r,n),u=t.mul(r,o),f=t.eql(t.sqr(a),e),c=t.eql(t.sqr(l),e);r=t.cmov(r,a,f),a=t.cmov(u,l,c);let h=t.eql(t.sqr(a),e),d=t.cmov(r,a,h);return t9(t,d,e),d}}(t):er(t)),o(c,e))),toBytes:t=>s?tV(t,f):tF(t,f),fromBytes:function(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(n){if(!n.includes(e.length)||e.length>f)throw Error("Field.fromBytes: expected "+n+" bytes, got "+e.length);let t=new Uint8Array(f);t.set(e,s?0:t.length-e.length),e=t}if(e.length!==f)throw Error("Field.fromBytes: expected "+f+" bytes, got "+e.length);let i=s?tH(e):tj(b(e));if(l&&(i=t8(i,t)),!r&&!c.isValid(i))throw Error("invalid field element: outside of range 0..ORDER");return i},invertBatch:t=>eo(c,t),cmov:(t,e,r)=>r?e:t});return Object.freeze(c)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let el=BigInt(0),eu=BigInt(1);function ef(t,e){let r=e.negate();return t?r:e}function ec(t,e){let r=eo(t.Fp,e.map(t=>t.Z));return e.map((e,i)=>t.fromAffine(e.toAffine(r[i])))}function eh(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw Error("invalid window size, expected [1.."+e+"], got W="+t)}function ed(t,e){eh(t,e);let r=Math.ceil(e/t)+1,i=2**(t-1),n=2**t;return{windows:r,windowSize:i,mask:tz(t),maxNumber:n,shiftBy:BigInt(t)}}function eg(t,e,r){let{windowSize:i,mask:n,maxNumber:o,shiftBy:s}=r,a=Number(t&n),l=t>>s;a>i&&(a-=o,l+=eu);let u=e*i,f=u+Math.abs(a)-1;return{nextN:l,offset:f,isZero:0===a,isNeg:a<0,isNegF:e%2!=0,offsetF:u}}let ey=new WeakMap,ep=new WeakMap;function eb(t){return ep.get(t)||1}function ew(t){if(t!==el)throw Error("invalid wNAF")}class em{_unsafeLadder(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.ZERO,i=t;for(;e>el;)e&eu&&(r=r.add(i)),i=i.double(),e>>=eu;return r}precomputeWindow(t,e){let{windows:r,windowSize:i}=ed(e,this.bits),n=[],o=t,s=o;for(let t=0;t<r;t++){s=o,n.push(s);for(let t=1;t<i;t++)s=s.add(o),n.push(s);o=s.double()}return n}wNAF(t,e,r){if(!this.Fn.isValid(r))throw Error("invalid scalar");let i=this.ZERO,n=this.BASE,o=ed(t,this.bits);for(let t=0;t<o.windows;t++){let{nextN:s,offset:a,isZero:l,isNeg:u,isNegF:f,offsetF:c}=eg(r,t,o);r=s,l?n=n.add(ef(f,e[c])):i=i.add(ef(u,e[a]))}return ew(r),{p:i,f:n}}wNAFUnsafe(t,e,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.ZERO,n=ed(t,this.bits);for(let t=0;t<n.windows&&r!==el;t++){let{nextN:o,offset:s,isZero:a,isNeg:l}=eg(r,t,n);if(r=o,!a){let t=e[s];i=i.add(l?t.negate():t)}}return ew(r),i}getPrecomputes(t,e,r){let i=ey.get(e);return i||(i=this.precomputeWindow(e,t),1!==t&&("function"==typeof r&&(i=r(i)),ey.set(e,i))),i}cached(t,e,r){let i=eb(t);return this.wNAF(i,this.getPrecomputes(i,t,r),e)}unsafe(t,e,r,i){let n=eb(t);return 1===n?this._unsafeLadder(t,e,i):this.wNAFUnsafe(n,this.getPrecomputes(n,t,r),e,i)}createCache(t,e){eh(e,this.bits),ep.set(t,e),ey.delete(t)}hasCache(t){return 1!==eb(t)}constructor(t,e){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=e}}function ev(t,e,r,i){!function(t,e){if(!Array.isArray(t))throw Error("array expected");t.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)})}(r,t),function(t,e){if(!Array.isArray(t))throw Error("array of scalars expected");t.forEach((t,r)=>{if(!e.isValid(t))throw Error("invalid scalar at index "+r)})}(i,e);let n=r.length,o=i.length;if(n!==o)throw Error("arrays of points and scalars must have equal length");let s=t.ZERO,a=function(t){let e;for(e=0;t>tN;t>>=tK,e+=1);return e}(BigInt(n)),l=1;a>12?l=a-3:a>4?l=a-2:a>0&&(l=2);let u=tz(l),f=Array(Number(u)+1).fill(s),c=Math.floor((e.BITS-1)/l)*l,h=s;for(let t=c;t>=0;t-=l){f.fill(s);for(let e=0;e<o;e++){let n=Number(i[e]>>BigInt(t)&u);f[n]=f[n].add(r[e])}let e=s;for(let t=f.length-1,r=s;t>0;t--)r=r.add(f[t]),e=e.add(r);if(h=h.add(e),0!==t)for(let t=0;t<l;t++)h=h.double()}return h}function eE(t,e){if(!e)return ea(t);if(e.ORDER!==t)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return tG(e,en.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),e}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let ex=BigInt(0),e_=BigInt(1),eA=BigInt(2),eB=BigInt(8);class eI{static fromBytes(t){throw Error("fromBytes must be implemented by subclass")}static fromHex(t){throw Error("fromHex must be implemented by subclass")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toRawBytes(){return this.toBytes()}toHex(){return b(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,e){return this.init(this.ep.precompute(t,e))}constructor(t){this.ep=t}}function eO(t){if(!Number.isSafeInteger(t))throw Error("number expected")}E("HashToScalar-");let eS=BigInt(0),eD=BigInt(1),eU=BigInt(2);BigInt(3);let eL=BigInt(5),eC=BigInt(8),eP={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:eC,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")},eR=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function eT(t,e){let r=eP.p,i=t8(e*e*e,r),n=function(t){let e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),o=eP.p,s=t*t%o*t%o,a=t5(s,eU,o)*s%o,l=t5(a,eD,o)*t%o,u=t5(l,eL,o)*l%o,f=t5(u,e,o)*u%o,c=t5(f,r,o)*f%o,h=t5(c,i,o)*c%o,d=t5(h,n,o)*h%o,g=t5(d,n,o)*h%o,y=t5(g,e,o)*u%o;return{pow_p_5_8:t5(y,eU,o)*t%o,b2:s}}(t*t8(i*i*e,r)).pow_p_5_8,o=t8(t*i*n,r),s=t8(e*o*o,r),a=o,l=t8(o*eR,r),u=s===t,f=s===t8(-t,r),c=s===t8(-t*eR,r);return u&&(o=a),(f||c)&&(o=l),ei(o,r)&&(o=t8(-o,r)),{isValid:u||f,value:o}}let ek=ea(eP.p,{isLE:!0}),eN=ea(eP.n,{isLE:!0}),eK=function(t){let{CURVE:e,curveOpts:r,hash:i,eddsaOpts:n}=function(t){let e={a:t.a,d:t.d,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r={Fp:t.Fp,Fn:ea(e.n,t.nBitLength,!0),uvRatio:t.uvRatio},i={randomBytes:t.randomBytes,adjustScalarBytes:t.adjustScalarBytes,domain:t.domain,prehash:t.prehash,mapToCurve:t.mapToCurve};return{CURVE:e,curveOpts:r,hash:t.hash,eddsaOpts:i}}(t),o=function(t,e,r){if("function"!=typeof e)throw Error('"hash" function param is required');tG(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:i}=r,{BASE:n,Fp:o,Fn:s}=t,a=s.ORDER,l=r.randomBytes||I,u=r.adjustScalarBytes||(t=>t),c=r.domain||((t,e,r)=>{if(tq("phflag",r),e.length||r)throw Error("Contexts/pre-hash are not supported");return t});function h(t){var e;return e=tH(t),s.create(e)}function d(t){let{head:r,prefix:i,scalar:s}=function(t){let r=o.BYTES;t=tM("private key",t,r);let i=tM("hashed private key",e(t),2*r),n=u(i.slice(0,r)),s=i.slice(r,2*r),a=h(n);return{head:n,prefix:s,scalar:a}}(t),a=n.multiply(s),l=a.toBytes();return{head:r,prefix:i,scalar:s,point:a,pointBytes:l}}function g(t){return d(t).pointBytes}function y(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uint8Array.of();for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return h(e(c(_(...n),tM("context",t),!!i)))}let p={zip215:!0};n.precompute(8);let b=o.BYTES,w={secret:b,public:b,signature:2*b,seed:b};function m(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l(w.seed);return t}let v={getExtendedPublicKey:d,randomSecretKey:m,isValidSecretKey:function(t){try{return!!s.fromBytes(t,!1)}catch(t){return!1}},isValidPublicKey:function(e,r){try{return!!t.fromBytes(e,r)}catch(t){return!1}},randomPrivateKey:m,toMontgomery(e){let{y:r}=t.fromBytes(e),i=32===b;if(!i&&57!==b)throw Error("only defined for 25519 and 448");let n=i?o.div(e_+r,e_-r):o.div(r-e_,r+e_);return o.toBytes(n)},toMontgomeryPriv:t=>(f(t,b),u(e(t.subarray(0,b))).subarray(0,b)),precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.BASE;return r.precompute(e,!1)}};return Object.freeze({keygen:function(t){let e=v.randomSecretKey(t);return{secretKey:e,publicKey:g(e)}},getPublicKey:g,sign:function(t,e){var r;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=tM("message",t),i&&(t=i(t));let{prefix:u,scalar:f,pointBytes:c}=d(e),h=y(l.context,u,t),g=n.multiply(h).toBytes(),p=(r=h+y(l.context,g,c,t)*f,s.create(r));tZ("signature.s",p,ex,a);let b=o.BYTES;return tM("result",_(g,tV(p,b)),2*b)},verify:function(e,r,s){let a,l,u,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p,{context:c,zip215:h}=f,d=o.BYTES;e=tM("signature",e,2*d),r=tM("message",r),s=tM("publicKey",s,d),void 0!==h&&tq("zip215",h),i&&(r=i(r));let g=tH(e.slice(d,2*d));try{a=t.fromHex(s,h),l=t.fromHex(e.slice(0,d),h),u=n.multiplyUnsafe(g)}catch(t){return!1}if(!h&&a.isSmallOrder())return!1;let b=y(c,l.toBytes(),a.toBytes(),r);return l.add(a.multiplyUnsafe(b)).subtract(u).clearCofactor().is0()},utils:v,Point:t,info:{type:"edwards",lengths:w}})}(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{Fp:r,Fn:i}=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||"object"!=typeof e)throw Error("expected valid ".concat(t," CURVE object"));for(let t of["p","n","h"]){let r=e[t];if(!("bigint"==typeof r&&r>el))throw Error("CURVE.".concat(t," must be positive bigint"))}let i=eE(e.p,r.Fp),n=eE(e.n,r.Fn);for(let r of["Gx","Gy","a","weierstrass"===t?"b":"d"])if(!i.isValid(e[r]))throw Error("CURVE.".concat(r," must be valid field element of CURVE.Fp"));return{Fp:i,Fn:n}}("edwards",t,e),{h:n,n:o}=t;tG(e,{},{uvRatio:"function"});let s=eA<<BigInt(8*i.BYTES)-e_,a=t=>r.create(t),l=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(r.div(t,e))}}catch(t){return{isValid:!1,value:ex}}});if(!function(t,e,r,i){let n=t.sqr(r),o=t.sqr(i),s=t.add(t.mul(e.a,n),o),a=t.add(t.ONE,t.mul(e.d,t.mul(n,o)));return t.eql(s,a)}(r,t,t.Gx,t.Gy))throw Error("bad curve params: generator point");function u(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tZ("coordinate "+t,e,r?e_:ex,s),e}function c(t){if(!(t instanceof g))throw Error("ExtendedPoint expected")}let h=tJ((t,e)=>{let{X:i,Y:n,Z:o}=t,s=t.is0();null==e&&(e=s?eB:r.inv(o));let l=a(i*e),u=a(n*e),f=r.mul(o,e);if(s)return{x:ex,y:e_};if(f!==e_)throw Error("invZ was invalid");return{x:l,y:u}}),d=tJ(e=>{let{a:r,d:i}=t;if(e.is0())throw Error("bad point: ZERO");let{X:n,Y:o,Z:s,T:l}=e,u=a(n*n),f=a(o*o),c=a(s*s),h=a(c*c),d=a(u*r);if(a(c*a(d+f))!==a(h+a(i*a(u*f))))throw Error("bad point: equation left != right (1)");if(a(n*o)!==a(s*l))throw Error("bad point: equation left != right (2)");return!0});class g{get x(){return this.toAffine().x}get y(){return this.toAffine().y}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(t){return ec(g,t)}static msm(t,e){return ev(g,i,t,e)}_setWindowSize(t){this.precompute(t)}static fromAffine(t){if(t instanceof g)throw Error("extended point not allowed");let{x:e,y:r}=t||{};return u("x",e),u("y",r),new g(e,r,e_,a(e*r))}precompute(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return y.createCache(this,t),e||this.multiply(eA),this}assertValidity(){d(this)}equals(t){c(t);let{X:e,Y:r,Z:i}=this,{X:n,Y:o,Z:s}=t,l=a(e*s),u=a(n*i),f=a(r*s),h=a(o*i);return l===u&&f===h}is0(){return this.equals(g.ZERO)}negate(){return new g(a(-this.X),this.Y,this.Z,a(-this.T))}double(){let{a:e}=t,{X:r,Y:i,Z:n}=this,o=a(r*r),s=a(i*i),l=a(eA*a(n*n)),u=a(e*o),f=r+i,c=a(a(f*f)-o-s),h=u+s,d=h-l,y=u-s,p=a(c*d),b=a(h*y),w=a(c*y);return new g(p,b,a(d*h),w)}add(e){c(e);let{a:r,d:i}=t,{X:n,Y:o,Z:s,T:l}=this,{X:u,Y:f,Z:h,T:d}=e,y=a(n*u),p=a(o*f),b=a(l*i*d),w=a(s*h),m=a((n+o)*(u+f)-y-p),v=w-b,E=w+b,x=a(p-r*y),_=a(m*v),A=a(E*x),B=a(m*x);return new g(_,A,a(v*E),B)}subtract(t){return this.add(t.negate())}multiply(t){tZ("scalar",t,e_,o);let{p:e,f:r}=y.cached(this,t,t=>ec(g,t));return ec(g,[e,r])[0]}multiplyUnsafe(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.ZERO;return(tZ("scalar",t,ex,o),t===ex)?g.ZERO:this.is0()||t===e_?this:y.unsafe(this,t,t=>ec(g,t),e)}isSmallOrder(){return this.multiplyUnsafe(n).is0()}isTorsionFree(){return y.unsafe(this,o).is0()}toAffine(t){return h(this,t)}clearCofactor(){return n===e_?this:this.multiplyUnsafe(n)}static fromBytes(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return f(t),g.fromHex(t,e)}static fromHex(e){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{d:n,a:o}=t,u=r.BYTES;e=tM("pointHex",e,u),tq("zip215",i);let f=e.slice(),c=e[u-1];f[u-1]=-129&c;let h=tH(f);tZ("pointHex.y",h,ex,i?s:r.ORDER);let d=a(h*h),{isValid:y,value:p}=l(a(d-e_),a(n*d-o));if(!y)throw Error("Point.fromHex: invalid y coordinate");let b=(p&e_)===e_,w=(128&c)!=0;if(!i&&p===ex&&w)throw Error("Point.fromHex: x=0 and x_0=1");return w!==b&&(p=a(-p)),g.fromAffine({x:p,y:h})}toBytes(){let{x:t,y:e}=this.toAffine(),i=tV(e,r.BYTES);return i[i.length-1]|=t&e_?128:0,i}toRawBytes(){return this.toBytes()}toHex(){return b(this.toBytes())}toString(){return"<Point ".concat(this.is0()?"ZERO":this.toHex(),">")}constructor(t,e,r,i){this.X=u("x",t),this.Y=u("y",e),this.Z=u("z",r,!0),this.T=u("t",i),Object.freeze(this)}}g.BASE=new g(t.Gx,t.Gy,e_,a(t.Gx*t.Gy)),g.ZERO=new g(ex,e_,e_,ex),g.Fp=r,g.Fn=i;let y=new em(g,8*i.BYTES);return g}(e,r),i,n);return Object.assign({},o,{ExtendedPoint:o.Point,CURVE:t})}({...eP,Fp:ek,hash:tn,adjustScalarBytes:function(t){return t[0]&=248,t[31]&=127,t[31]|=64,t},uvRatio:eT}),eq=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),ej=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),eH=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),eF=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),eV=t=>eT(eD,t),eM=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),eW=t=>eK.CURVE.Fp.create(tH(t)&eM);function eZ(t){let{d:e}=eK.CURVE,r=eK.CURVE.Fp.ORDER,i=eK.CURVE.Fp.create,n=i(eR*t*t),o=i((n+eD)*eH),s=BigInt(-1),a=i((s-e*n)*i(n+e)),{isValid:l,value:u}=eT(o,a),f=i(u*t);ei(f,r)||(f=i(-f)),l||(u=f),l||(s=n);let c=i(s*(n-eD)*eF-a),h=u*u,d=i((u+u)*a),g=i(c*eq),y=i(eD-h),p=i(eD+h);return new eK.Point(i(d*p),i(y*g),i(g*p),i(d*y))}class ez extends eI{static fromAffine(t){return new ez(eK.Point.fromAffine(t))}assertSame(t){if(!(t instanceof ez))throw Error("RistrettoPoint expected")}init(t){return new ez(t)}static hashToCurve(t){return function(t){f(t,64);let e=eZ(eW(t.subarray(0,32))),r=eZ(eW(t.subarray(32,64)));return new ez(e.add(r))}(tM("ristrettoHash",t,64))}static fromBytes(t){f(t,32);let{a:e,d:r}=eK.CURVE,i=ek.ORDER,n=ek.create,o=eW(t);if(!function(t,e){if(t.length!==e.length)return!1;let r=0;for(let i=0;i<t.length;i++)r|=t[i]^e[i];return 0===r}(tV(o,32),t)||ei(o,i))throw Error("invalid ristretto255 encoding 1");let s=n(o*o),a=n(eD+e*s),l=n(eD-e*s),u=n(a*a),c=n(l*l),h=n(e*r*u-c),{isValid:d,value:g}=eV(n(h*c)),y=n(g*l),p=n(g*y*h),b=n((o+o)*y);ei(b,i)&&(b=n(-b));let w=n(a*p),m=n(b*w);if(!d||ei(m,i)||w===eS)throw Error("invalid ristretto255 encoding 2");return new ez(new eK.Point(b,w,eD,m))}static fromHex(t){return ez.fromBytes(tM("ristrettoHex",t,32))}static msm(t,e){return ev(ez,eK.Point.Fn,t,e)}toBytes(){let t,{X:e,Y:r,Z:i,T:n}=this.ep,o=ek.ORDER,s=ek.create,a=s(s(i+r)*s(i-r)),l=s(e*r),u=s(l*l),{value:f}=eV(s(a*u)),c=s(f*a),h=s(f*l),d=s(c*h*n);if(ei(n*d,o)){let i=s(r*eR),n=s(e*eR);e=i,r=n,t=s(c*ej)}else t=h;ei(e*d,o)&&(r=s(-r));let g=s((i-r)*t);return ei(g,o)&&(g=s(-g)),tV(g,32)}equals(t){this.assertSame(t);let{X:e,Y:r}=this.ep,{X:i,Y:n}=t.ep,o=ek.create,s=o(e*n)===o(r*i),a=o(r*n)===o(e*i);return s||a}is0(){return this.equals(ez.ZERO)}constructor(t){super(t)}}function eG(t){return null!==t&&"object"==typeof t}ez.BASE=new ez(eK.Point.BASE),ez.ZERO=new ez(eK.Point.ZERO),ez.Fp=ek,ez.Fn=eN;var eJ=new WeakMap,eY=new WeakMap;class eX{static from(t){if("string"==typeof t){let e=v(t);return this.fromRaw(e)}if(eG(t)){if(eG(t)&&Object.hasOwnProperty.call(t,"__derEncodedPublicKey__"))return this.fromDer(t);if(ArrayBuffer.isView(t))return this.fromRaw(tl(t.buffer));if(t instanceof ArrayBuffer)return this.fromRaw(tl(t));if("rawKey"in t&&t.rawKey instanceof Uint8Array)return this.fromRaw(t.rawKey);else if("derKey"in t)return this.fromDer(t.derKey);else if("toDer"in t)return this.fromDer(t.toDer())}throw Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(t){return new eX(t)}static fromDer(t){return new eX(this.derDecode(t))}static derEncode(t){let e=function(t,e){let r=2+tL(t.byteLength+1),i=e.byteLength+r+t.byteLength,n=0,o=new Uint8Array(1+tL(i)+i);return o[n++]=48,n+=tC(o,n,i),o.set(e,n),n+=e.byteLength,o[n++]=3,n+=tC(o,n,t.byteLength+1),o[n++]=0,o.set(new Uint8Array(t),n),o}(t,tT);return e.__derEncodedPublicKey__=void 0,e}static derDecode(t){let e=tk(t,tT);if(e.length!==this.RAW_KEY_LENGTH)throw Error("An Ed25519 public key must be exactly 32bytes long");return e}get rawKey(){return(0,tS._)(this,eJ)}get derKey(){return(0,tS._)(this,eY)}toDer(){return this.derKey}toRaw(){return this.rawKey}constructor(t){if((0,tD._)(this,eJ,{writable:!0,value:void 0}),(0,tD._)(this,eY,{writable:!0,value:void 0}),t.byteLength!==eX.RAW_KEY_LENGTH)throw Error("An Ed25519 public key must be exactly 32bytes long");(0,tU._)(this,eJ,t),(0,tU._)(this,eY,eX.derEncode(t))}}eX.RAW_KEY_LENGTH=32;var e$=new WeakMap,eQ=new WeakMap;class e0 extends t_{static generate(t){if(t&&32!==t.length)throw Error("Ed25519 Seed needs to be 32 bytes long.");t||(t=eK.utils.randomPrivateKey()),0===tu(t,new Uint8Array(Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");let e=new Uint8Array(32);for(let r=0;r<32;r++)e[r]=t[r];let r=eK.getPublicKey(e);return e0.fromKeyPair(r,e)}static fromParsedJson(t){let[e,r]=t;return new e0(eX.fromDer(v(e)),v(r))}static fromJSON(t){let e=JSON.parse(t);if(Array.isArray(e)){if("string"==typeof e[0]&&"string"==typeof e[1])return this.fromParsedJson([e[0],e[1]]);throw Error("Deserialization error: JSON must have at least 2 items.")}throw Error("Deserialization error: Invalid JSON type for string: ".concat(JSON.stringify(t)))}static fromKeyPair(t,e){return new e0(eX.fromRaw(t),e)}static fromSecretKey(t){let e=eK.getPublicKey(t);return e0.fromKeyPair(e,t)}toJSON(){return[b((0,tS._)(this,e$).toDer()),b((0,tS._)(this,eQ))]}getKeyPair(){return{secretKey:(0,tS._)(this,eQ),publicKey:(0,tS._)(this,e$)}}getPublicKey(){return(0,tS._)(this,e$)}async sign(t){let e=eK.sign(t,(0,tS._)(this,eQ).slice(0,32));return Object.defineProperty(e,"__signature__",{enumerable:!1,value:void 0}),e}static verify(t,e,r){let[i,n,o]=[t,e,r].map(t=>("string"==typeof t&&(t=v(t)),tl(t)));return eK.verify(i,n,o)}constructor(t,e){super(),(0,tD._)(this,e$,{writable:!0,value:void 0}),(0,tD._)(this,eQ,{writable:!0,value:void 0}),(0,tU._)(this,e$,eX.from(t)),(0,tU._)(this,eQ,e)}}class e1 extends Error{constructor(t){super(t),this.message=t,Object.setPrototypeOf(this,e1.prototype)}}function e2(t){if("undefined"!=typeof global&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(t)return t;if("undefined"!=typeof crypto&&crypto.subtle)return crypto.subtle;throw new e1("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class e3 extends t_{static async generate(t){let{extractable:e=!1,keyUsages:r=["sign","verify"],subtleCrypto:i}=null!=t?t:{},n=e2(i),o=await n.generateKey({name:"ECDSA",namedCurve:"P-256"},e,r),s=tl(await n.exportKey("spki",o.publicKey));return Object.assign(s,{__derEncodedPublicKey__:void 0}),new this(o,s,n)}static async fromKeyPair(t,e){let r=e2(e),i=tl(await r.exportKey("spki",t.publicKey));return Object.assign(i,{__derEncodedPublicKey__:void 0}),new e3(t,i,r)}getKeyPair(){return this._keyPair}getPublicKey(){let t=this._derKey,e=Object.create(this._keyPair.publicKey);return e.toDer=function(){return t},e}async sign(t){let e=tl(await this._subtleCrypto.sign({name:"ECDSA",hash:{name:"SHA-256"}},this._keyPair.privateKey,t));return Object.assign(e,{__signature__:void 0}),e}constructor(t,e,r){super(),this._keyPair=t,this._derKey=e,this._subtleCrypto=r}}var e6=new WeakMap;class e4{get rawKey(){return(0,tS._)(this,e6).rawKey}get derKey(){return(0,tS._)(this,e6).derKey}toDer(){return(0,tS._)(this,e6).toDer()}getPublicKey(){return(0,tS._)(this,e6)}getPrincipal(){if(!(0,tS._)(this,e6).rawKey)throw Error("Cannot get principal from a public key without a raw key.");return ts.fromUint8Array(new Uint8Array((0,tS._)(this,e6).rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}constructor(t){(0,tD._)(this,e6,{writable:!0,value:void 0}),(0,tU._)(this,e6,t)}}function e8(t){if("string"!=typeof t||t.length<64)throw Error("Invalid public key.");return v(t)}class e5{toCborValue(){return{pubkey:this.pubkey,expiration:this.expiration,...this.targets&&{targets:this.targets}}}toJSON(){return{expiration:this.expiration.toString(16),pubkey:b(this.pubkey),...this.targets&&{targets:this.targets.map(t=>t.toHex())}}}constructor(t,e,r){this.pubkey=t,this.expiration=e,this.targets=r}}async function e7(t,e,r,i){let n=new e5(e.toDer(),BigInt(+r)*BigInt(1e6),i),o=new Uint8Array([...tx,...new Uint8Array(tv({...n}))]);return{delegation:n,signature:await t.sign(o)}}class e9{static async create(t,e){var r,i;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date(Date.now()+9e5),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=await e7(t,e,n,o.targets);return new e9([...(null===(r=o.previous)||void 0===r?void 0:r.delegations)||[],s],(null===(i=o.previous)||void 0===i?void 0:i.publicKey)||t.getPublicKey().toDer())}static fromJSON(t){let{publicKey:e,delegations:r}="string"==typeof t?JSON.parse(t):t;if(!Array.isArray(r))throw Error("Invalid delegations.");return new this(r.map(t=>{let{delegation:e,signature:r}=t,{pubkey:i,expiration:n,targets:o}=e;if(void 0!==o&&!Array.isArray(o))throw Error("Invalid targets.");return{delegation:new e5(e8(i),BigInt("0x"+n),o&&o.map(t=>{if("string"!=typeof t)throw Error("Invalid target.");return ts.fromHex(t)})),signature:e8(r)}}),e8(e))}static fromDelegations(t,e){return new this(t,e)}toJSON(){return{delegations:this.delegations.map(t=>{let{delegation:e,signature:r}=t,{targets:i}=e;return{delegation:{expiration:e.expiration.toString(16),pubkey:b(e.pubkey),...i&&{targets:i.map(t=>t.toHex())}},signature:b(r)}}),publicKey:b(this.publicKey)}}constructor(t,e){this.delegations=t,this.publicKey=e}}class rt extends t_{static fromDelegation(t,e){return new this(t,e)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(t){return this._inner.sign(t)}async transformRequest(t){let{body:e,...r}=t,i=await tv(e);return{...r,body:{content:e,sender_sig:await this.sign(new Uint8Array([...tE,...new Uint8Array(i)])),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}}}constructor(t,e){super(),this._inner=t,this._delegation=e}}var re=new WeakMap;class rr extends e4{get delegation(){return(0,tS._)(this,re)}static fromDelegation(t,e){return new rr(t,e)}constructor(t,e){super(t),(0,tD._)(this,re,{writable:!0,value:void 0}),(0,tU._)(this,re,e)}}function ri(t,e){for(let{delegation:e}of t.delegations)if(+new Date(Number(e.expiration/BigInt(1e6)))<=+Date.now())return!1;let r=[],i=null==e?void 0:e.scope;for(let e of(i&&(Array.isArray(i)?r.push(...i.map(t=>"string"==typeof t?ts.fromText(t):t)):r.push("string"==typeof i?ts.fromText(i):i)),r)){let r=e.toText();for(let{delegation:e}of t.delegations){if(void 0===e.targets)continue;let t=!0;for(let i of e.targets)if(i.toText()===r){t=!1;break}if(t)return!1}}return!0}let rn=["mousedown","mousemove","keydown","touchstart","wheel"];class ro{static create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new this(t)}registerCallback(t){this.callbacks.push(t)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);let t=this._resetTimer.bind(this);rn.forEach(function(e){document.removeEventListener(e,t,!0)}),this.callbacks.forEach(t=>t())}_resetTimer(){let t=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(t,this.idleTimeout)}constructor(t={}){this.callbacks=[],this.idleTimeout=6e5,this.timeoutID=void 0;let{onIdle:e,idleTimeout:r=6e5}=t||{};this.callbacks=e?[e]:[],this.idleTimeout=r;let i=this._resetTimer.bind(this);if(window.addEventListener("load",i,!0),rn.forEach(function(t){document.addEventListener(t,i,!0)}),null==t?void 0:t.captureScroll){var n;let e=((t,e)=>{let r;var i=this;return function(){for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];clearTimeout(r),r=window.setTimeout(function(){r=void 0,t.apply(i,o)},e)}})(i,null!==(n=null==t?void 0:t.scrollDebounce)&&void 0!==n?n:100);window.addEventListener("scroll",e,!0)}i()}}let rs=(t,e)=>e.some(e=>t instanceof e),ra=new WeakMap,rl=new WeakMap,ru=new WeakMap,rf=new WeakMap,rc=new WeakMap,rh={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return rl.get(t);if("objectStoreNames"===e)return t.objectStoreNames||ru.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return rd(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function rd(t){var e;if(t instanceof IDBRequest)return function(t){let e=new Promise((e,r)=>{let i=()=>{t.removeEventListener("success",n),t.removeEventListener("error",o)},n=()=>{e(rd(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",n),t.addEventListener("error",o)});return e.then(e=>{e instanceof IDBCursor&&ra.set(e,t)}).catch(()=>{}),rc.set(e,t),e}(t);if(rf.has(t))return rf.get(t);let r="function"==typeof(e=t)?e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(n||(n=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.apply(rg(this),r),rd(ra.get(this))}:function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return rd(e.apply(rg(this),r))}:function(t){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];let o=e.call(rg(this),t,...i);return ru.set(o,t.sort?t.sort():[t]),rd(o)}:(e instanceof IDBTransaction&&function(t){if(rl.has(t))return;let e=new Promise((e,r)=>{let i=()=>{t.removeEventListener("complete",n),t.removeEventListener("error",o),t.removeEventListener("abort",o)},n=()=>{e(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",n),t.addEventListener("error",o),t.addEventListener("abort",o)});rl.set(t,e)}(e),rs(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,rh):e;return r!==t&&(rf.set(t,r),rc.set(r,t)),r}let rg=t=>rc.get(t),ry=["get","getKey","getAll","getAllKeys","count"],rp=["put","add","delete","clear"],rb=new Map;function rw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&"string"==typeof e))return;if(rb.get(e))return rb.get(e);let r=e.replace(/FromIndex$/,""),i=e!==r,n=rp.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(n||ry.includes(r)))return;let o=async function(t){for(var e=arguments.length,o=Array(e>1?e-1:0),s=1;s<e;s++)o[s-1]=arguments[s];let a=this.transaction(t,n?"readwrite":"readonly"),l=a.store;return i&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),n&&a.done]))[0]};return rb.set(e,o),o}rh={...tB=rh,get:(t,e,r)=>rw(t,e)||tB.get(t,e,r),has:(t,e)=>!!rw(t,e)||tB.has(t,e)};let rm="auth-client-db",rv="ic-keyval",rE=async function(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rm,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rv,i=arguments.length>2?arguments[2]:void 0;return rD&&(null===(t=localStorage)||void 0===t?void 0:t.getItem(rO))&&(localStorage.removeItem(rO),localStorage.removeItem(rI)),await function(t,e){let{blocked:r,upgrade:i,blocking:n,terminated:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=indexedDB.open(t,e),a=rd(s);return i&&s.addEventListener("upgradeneeded",t=>{i(rd(s.result),t.oldVersion,t.newVersion,rd(s.transaction),t)}),r&&s.addEventListener("blocked",t=>r(t.oldVersion,t.newVersion,t)),a.then(t=>{o&&t.addEventListener("close",()=>o()),n&&t.addEventListener("versionchange",t=>n(t.oldVersion,t.newVersion,t))}).catch(()=>{}),a}(e,i,{upgrade:t=>{t.objectStoreNames.contains(r)&&t.clear(r),t.createObjectStore(r)}})};async function rx(t,e,r){return await t.get(e,r)}async function r_(t,e,r,i){return await t.put(e,i,r)}async function rA(t,e,r){return await t.delete(e,r)}class rB{static async create(t){let{dbName:e=rm,storeName:r=rv,version:i=rS}=null!=t?t:{};return new rB(await rE(e,r,i),r)}async set(t,e){return await r_(this._db,this._storeName,t,e)}async get(t){var e;return null!==(e=await rx(this._db,this._storeName,t))&&void 0!==e?e:null}async remove(t){return await rA(this._db,this._storeName,t)}constructor(t,e){this._db=t,this._storeName=e}}let rI="identity",rO="delegation",rS=1,rD=!0;class rU{get(t){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+t))}set(t,e){return this._getLocalStorage().setItem(this.prefix+t,e),Promise.resolve()}remove(t){return this._getLocalStorage().removeItem(this.prefix+t),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;let t=window.localStorage;if(!t)throw Error("Could not find local storage.");return t}constructor(t="ic-",e){this.prefix=t,this._localStorage=e}}var rL=new WeakMap;class rC{get _db(){return new Promise(t=>{if(this.initializedDb){t(this.initializedDb);return}rB.create((0,tS._)(this,rL)).then(e=>{this.initializedDb=e,t(e)})})}async get(t){let e=await this._db;return await e.get(t)}async set(t,e){let r=await this._db;await r.set(t,e)}async remove(t){let e=await this._db;await e.remove(t)}constructor(t){(0,tD._)(this,rL,{writable:!0,value:void 0}),(0,tU._)(this,rL,null!=t?t:{})}}let rP=BigInt(1e9),rR=BigInt(3600),rT=BigInt(8)*(rP*rR),rk="ECDSA",rN="Ed25519";class rK{static async create(){var t,e,r;let i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=null!==(e=n.storage)&&void 0!==e?e:new rC,s=null!==(r=n.keyType)&&void 0!==r?r:rk,a=null;if(n.identity)a=n.identity;else{let t=await o.get(rI);if(!t&&rD)try{let e=new rU,r=await e.get(rO),i=await e.get(rI);r&&i&&s===rk&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await o.set(rO,r),await o.set(rI,i),t=r,await e.remove(rO),await e.remove(rI))}catch(t){console.error("error while attempting to recover localstorage: "+t)}if(t)try{"object"==typeof t?a=s===rN&&"string"==typeof t?e0.fromJSON(t):await e3.fromKeyPair(t):"string"==typeof t&&(a=e0.fromJSON(t))}catch(t){}}let l=new tA,u=null;if(a)try{let t=await o.get(rO);if("object"==typeof t&&null!==t)throw Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");n.identity?l=n.identity:t&&(u=e9.fromJSON(t),ri(u)?l="toDer"in a?rr.fromDelegation(a,u):rt.fromDelegation(a,u):(await rq(o),a=null))}catch(t){console.error(t),await rq(o),a=null}return(null===(t=n.idleOptions)||void 0===t?void 0:t.disableIdle)?i=void 0:(u||n.identity)&&(i=ro.create(n.idleOptions)),a||(s===rN?(a=e0.generate(),await o.set(rI,JSON.stringify(a.toJSON()))):(n.storage&&s===rk&&console.warn("You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '".concat(rN,"' as the key type, as it can serialize to a string")),a=await e3.generate(),await o.set(rI,a.getKeyPair()))),new this(l,a,u,o,i,n)}_registerDefaultIdleCallback(){var t,e;let r=null===(t=this._createOptions)||void 0===t?void 0:t.idleOptions;(null==r?void 0:r.onIdle)||(null==r?void 0:r.disableDefaultIdleCallback)||null===(e=this.idleManager)||void 0===e||e.registerCallback(()=>{this.logout(),location.reload()})}async _handleSuccess(t,e){var r,i;let n=t.delegations.map(t=>({delegation:new e5(t.delegation.pubkey,t.delegation.expiration,t.delegation.targets),signature:t.signature})),o=e9.fromDelegations(n,t.userPublicKey),s=this._key;if(!s)return;this._chain=o,"toDer"in s?this._identity=rr.fromDelegation(s,this._chain):this._identity=rt.fromDelegation(s,this._chain),null===(r=this._idpWindow)||void 0===r||r.close();let a=null===(i=this._createOptions)||void 0===i?void 0:i.idleOptions;this.idleManager||(null==a?void 0:a.disableIdle)||(this.idleManager=ro.create(a),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(rO,JSON.stringify(this._chain.toJSON())),null==e||e(t)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&null!==this._chain&&ri(this._chain)}async login(t){var e,r,i,n,o;let s=function(t,e){if(!t&&!e)return;let r=(null==t?void 0:t.customValues)||(null==e?void 0:e.customValues)?{...null==t?void 0:t.customValues,...null==e?void 0:e.customValues}:void 0;return{...t,...e,customValues:r}}(null===(e=this._createOptions)||void 0===e?void 0:e.loginOptions,t),a=null!==(n=null==s?void 0:s.maxTimeToLive)&&void 0!==n?n:rT,l=new URL((null==s?void 0:null===(r=s.identityProvider)||void 0===r?void 0:r.toString())||"https://identity.internetcomputer.org");l.hash="#authorize",null===(i=this._idpWindow)||void 0===i||i.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(l,{maxTimeToLive:a,...s}),window.addEventListener("message",this._eventHandler),this._idpWindow=null!==(o=window.open(l.toString(),"idpWindow",null==s?void 0:s.windowOpenerFeatures))&&void 0!==o?o:void 0;let u=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure("UserInterrupt",null==s?void 0:s.onError):setTimeout(u,500))};u()}_getEventHandler(t,e){return async r=>{if(r.origin!==t.origin)return;let i=r.data;switch(i.kind){case"authorize-ready":{var n,o,s;let r={kind:"authorize-client",sessionPublicKey:new Uint8Array(null===(n=this._key)||void 0===n?void 0:n.getPublicKey().toDer()),maxTimeToLive:null==e?void 0:e.maxTimeToLive,allowPinAuthentication:null==e?void 0:e.allowPinAuthentication,derivationOrigin:null==e?void 0:null===(o=e.derivationOrigin)||void 0===o?void 0:o.toString(),...null==e?void 0:e.customValues};null===(s=this._idpWindow)||void 0===s||s.postMessage(r,t.origin);break}case"authorize-client-success":try{await this._handleSuccess(i,null==e?void 0:e.onSuccess)}catch(t){this._handleFailure(t.message,null==e?void 0:e.onError)}break;case"authorize-client-failure":this._handleFailure(i.text,null==e?void 0:e.onError)}}}_handleFailure(t,e){var r;null===(r=this._idpWindow)||void 0===r||r.close(),null==e||e(t),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(await rq(this._storage),this._identity=new tA,this._chain=null,t.returnTo)try{window.history.pushState({},"",t.returnTo)}catch(e){window.location.href=t.returnTo}}constructor(t,e,r,i,n,o,s,a){this._identity=t,this._key=e,this._chain=r,this._storage=i,this.idleManager=n,this._createOptions=o,this._idpWindow=s,this._eventHandler=a,this._registerDefaultIdleCallback()}}async function rq(t){await t.remove(rI),await t.remove(rO),await t.remove("iv")}},5840:function(t,e,r){r.d(e,{E:function(){return i}});function i(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}},2365:function(t,e,r){r.d(e,{J:function(){return i}});function i(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}},2742:function(t,e,r){r.d(e,{_:function(){return n}});var i=r(2365);function n(t,e){var r=(0,i.J)(t,e,"get");return r.get?r.get.call(t):r.value}},7640:function(t,e,r){r.d(e,{_:function(){return n}});var i=r(5840);function n(t,e,r){(0,i.E)(t,e),e.set(t,r)}},7175:function(t,e,r){r.d(e,{_:function(){return n}});var i=r(2365);function n(t,e,r){var n=(0,i.J)(t,e,"set");return!function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,n,r),r}}}]);